{% extends "auctions/main.html" %}

{% block title %}Licitație: {{ auction.car.name }}{% endblock %}

{% block content %}
  <h2>{{ auction.car.name }}</h2>
  {% if auction.car.image %}
    <img src="{{ auction.car.image.url }}" alt="Imagine {{ auction.car.name }}" class="img-fluid mb-3" style="max-width: 400px;">
  {% endif %}
  <p><strong>Descriere:</strong> {{ auction.car.description }}</p>
  <p><strong>Preț de pornire:</strong> {{ auction.car.price }} lei</p>
  <p><strong>Licitația se termină la:</strong> {{ auction.end_time|date:"d.m.Y H:i" }}</p>
  <hr>
  <h4>Bid-uri pentru această licitație:</h4>
  {% if bids %}
    <ul class="list-group mb-3">
      {% for bid in bids %}
        <li class="list-group-item d-flex justify-content-between align-items-center">
          <span>
            <strong>{{ bid.user.username }}</strong> — {{ bid.amount }} lei
          </span>
          <small class="text-muted">{{ bid.created_at|date:"d.m.Y H:i" }}</small>
        </li>
      {% endfor %}
    </ul>
  {% else %}
    <p>Nu există încă bid-uri pentru această licitație.</p>
  {% endif %}
  <hr>
  {% if user.is_authenticated %}
  <h4>Bid-uri pentru această licitație:</h4>
{% if bids %}
  <ul class="list-group mb-3">
    {% for bid in bids %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <span>
          <strong>{{ bid.user.username }}</strong> — {{ bid.amount }} lei
        </span>
        <small class="text-muted">{{ bid.created_at|date:"d.m.Y H:i" }}</small>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p>Nu există încă bid-uri pentru această licitație.</p>
{% endif %}
    <h4>Pune un bid nou:</h4>
    <form method="post" action="{% url 'place_bid' auction.id %}">
      {% csrf_token %}
      <div class="mb-2">
        <input type="number" name="amount" step="0.01" min="{{ bids.0.amount|default:auction.car.price }}" class="form-control" required placeholder="Suma ta">
      </div>
      <button type="submit" class="btn btn-success">Licitează</button>
    </form>
  {% else %}
    <p><a href="{% url 'login' %}">Loghează-te</a> ca să poți licita.</p>
  {% endif %}
  <div class="mt-3">
    <a href="{% url 'auction_list' %}">&larr; Înapoi la lista licitațiilor</a>
  </div>
{% endblock %}